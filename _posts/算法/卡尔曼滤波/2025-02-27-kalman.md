---
layout:     post
title:      å¡å°”æ›¼æ»¤æ³¢è¯¦è§£
date:       2025-02-27
author:     phoenixZ
header-img: img/bg-little-universe.jpg
catalog: true
tags:
    - ç®—æ³•
    - å¡å°”æ›¼
---
# ä¸€ é€šè¿‡å®ä¾‹äº†è§£å¡å°”æ›¼

1. å‡è®¾ç”¨å°ºå­åˆ†åˆ«å»é‡ä¸€æšç¡¬å¸å°ºå¯¸

   $$
   Z_1 = 50.1 \text{ mm}, \quad Z_2 = 50.2 \text{ mm}, \quad Z_3 = 49.5 \text{ mm}
   $$

   $$
   Z_t \text{ è¡¨ç¤ºæ¯æ¬¡æµ‹é‡çš„ç»“æœ}
   $$

2. ç¬¬tæ¬¡çš„æµ‹é‡ç»“æœå¯ä»¥ç”¨å¦‚ä¸‹å…¬å¼è¡¨ç¤ºï¼š

   $$
   \hat X_t = \frac{1}{t}(Z_1 + Z_2 + Z_3 + \ldots + Z_t)
   $$

   é€šè¿‡é€æ­¥å±•å¼€ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š

   $$
   \hat X_t = \frac{1}{t}(Z_1 + Z_2 + \ldots + Z_{t-1}) + \frac{1}{t}Z_t
   $$

   $$
   = \frac{1}{t} \cdot \frac{t-1}{t-1}(Z_1 + Z_2 + \ldots + Z_{t-1}) + \frac{1}{t}Z_t
   $$

   $$
   = \frac{1}{t}(t-1)\hat X_{t-1} + \frac{1}{t}Z_t
   $$

   $$
   = \hat X_{t-1} - \frac{\hat X_{t-1}}{t} + \frac{1}{t}Z_t
   $$

   $$
   = \hat X_{t-1} + \frac{1}{t}(Z_t - \hat X_{t-1})
   $$

   å…¶ä¸­ï¼Œ$\hat X_t$ è¡¨ç¤ºç¬¬tæ¬¡çš„æœ€ä¼˜ä¼°è®¡ï¼Œéšç€æ¬¡æ•°çš„å¢åŠ ï¼Œ$\hat X_t$ å°†æ— é™æ¥è¿‘äº $\hat X_{t-1}$ã€‚

   ä»¤ $K_t = \frac{1}{t}$ï¼Œåˆ™æœ‰ï¼š

   $$
   \hat X_t = \hat X_{t-1} + K_t(Z_t - \hat X_{t-1}) \tag{1}
   $$
3. ä¸Šè¿°å…¬å¼è¡¨ç¤ºï¼š å½“å‰çš„ä¼°è®¡å€¼ = ä¸Šä¸€æ—¶åˆ»ä¼°è®¡å€¼ + ç³»æ•°(å½“å‰æµ‹é‡å€¼ - ä¸Šä¸€æ—¶åˆ»çš„ä¼°è®¡å€¼)
4. æ ¹æ®ä¼°è®¡è¯¯å·®å’Œæµ‹é‡è¯¯å·®æ±‚å¡å°”æ›¼å¢ç›Š

   $$
   \text{å‡è®¾ä¼°è®¡è¯¯å·®ä¸ºï¼š} e_{est}, \quad \text{æµ‹é‡è¯¯å·®ä¸º: } e_{mea} \quad \text{åˆ™æœ‰:}
   $$

   $$
   K_t = \frac{e_{est_{t-1}}}{e_{est_{t-1}} + e_{mea_t}} \tag{2}
   $$
5. å¾—åˆ°å¡å°”æ›¼æ»¤æ³¢æ›´æ–°çš„ä¸‰ä¸ªå…¬å¼

   $$
   \begin{align*}
   K_t &= \frac{e_{est_{k-1}}}{e_{est_{k-1}} + e_{mea_k}} \\
   \hat X_t &= \hat X_{t-1} + K_t(Z_t - \hat X_{t-1}) \\
   e_{est_t} &= (1 - K_t) \cdot e_{est_{t-1}}
   \end{align*}
   $$

# äºŒ æ•°æ®èåˆçš„æ€æƒ³ç†è§£å¡å°”æ›¼æ»¤æ³¢

## ğŸš€ æ–¹å·®ã€æ ‡å‡†å·®ã€åæ–¹å·®çš„æ¦‚å¿µ

æ–¹å·®ï¼š æ˜¯æŒ‡æ•°æ®é›†åˆä¸­å„ä¸ªæ•°æ®ä¸å…¶å¹³å‡å€¼ä¹‹å·®çš„å¹³æ–¹å’Œçš„å¹³å‡å€¼

$$
VAR(X) = \frac{1}{n} \sum_{i=1}^n (x_i - \mu)^2
$$

æ ‡å‡†å·®ï¼š æ˜¯æ–¹å·®çš„å¹³æ–¹æ ¹ï¼Œç”¨äºè¡¡é‡æ•°æ®é›†åˆä¸­å„ä¸ªæ•°æ®ä¸å…¶å¹³æ–¹å€¼çš„åç¦»ç¨‹åº¦

$$
SD(X) = \sqrt{VAR(X)}
$$

åæ–¹å·®ï¼š ç”¨æ¥è¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„æ€»ä½“ç›¸å…³ç¨‹åº¦ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªéšæœºå˜é‡Xï¼ŒYï¼Œåˆ™å…¶åæ–¹å·®çš„è®¡ç®—å…¬å¼ä¸ºï¼š

$$
Cov(X,Y) = \frac{1}{n} \sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y})
$$


## ğŸš€ å®é™…ä¾‹å­ç†è§£æ–¹å·®ã€åæ–¹å·®ã€æ ‡å‡†å·®

| çƒå‘˜   | èº«é«˜  | ä½“é‡ | å¹´é¾„ |
| :----- | ----- | :--: | ---- |
| A      | 179   |  74  | 33   |
| B      | 187   |  80  | 31   |
| C      | 175   |  71  | 28   |
| å¹³å‡å€¼ | 180.3 |  75  | 30.7 |

æ ¹æ®æ–¹å·®çš„è®¡ç®—å…¬å¼æœ‰ï¼š

$$
\begin{align*}
   VAR(X) &= \frac{1}{3}[(179-180.3)^2 + (187-180.3)^2 + (175-180.3)^2] = 24.89 \\
   VAR(Y) &= 14 \\
   VAR(Z) &= 4.22
   \end{align*}
$$

   



æ ¹æ®åæ–¹å·®è®¡ç®—å…¬å¼ï¼š

$$
cov(X,Y) = \frac{1}{3}[(179-180.3)(74-75) + (187-180.3)(80-75) + (175-180.3)(71-75)] = cov(Y,X)
$$



## ğŸš€ æ•°æ®èåˆä¸¾ä¾‹

![å¼¹ç°§é˜»å°¼ç³»ç»Ÿ]({{ site.baseurl }}/img/kalman.png)

å¦‚å›¾æ‰€ç¤ºä¾‹ï¼Œæ˜¯ä¸€ä¸ªå¼¹ç°§é˜»å°¼ç³»ç»Ÿï¼Œmä»£è¡¨è´¨é‡ï¼ŒFä»£è¡¨åŠ›å³ç³»ç»Ÿè¾“å…¥uï¼ŒKä»£è¡¨ç¬¦å¤åˆç³»æ•°ï¼ŒBä»£è¡¨é˜»å°¼ç³»æ•°

$$
m\ddot{x} + B\dot{x} + Kx = F
$$

$$
\text{ä»¤ } x_1 = x, \quad x_2 = \dot{x}
$$

$$
\dot{x}_1 = x_2, \quad \dot{x}_2 = \frac{1}{m}F - \frac{B}{m}x_2 - \frac{K}{m}x_1
$$

å¾—åˆ°çŸ©é˜µå…³ç³»:

$$
\begin{bmatrix}
\dot{x}_1 \\
\dot{x}_2
\end{bmatrix}
=
\begin{bmatrix}
0 & 1 \\
-\frac{K}{m} & -\frac{B}{m}
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2
\end{bmatrix}
+
\begin{bmatrix}
0 \\
\frac{1}{m}
\end{bmatrix}
F
$$

å› æ­¤ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªçŠ¶æ€å…¬å¼ï¼š

$$
\dot{X}_t = AX_t + BU_t \tag{3}
$$

å¯¹äºçŠ¶æ€é‡ä½ç½®å’Œé€Ÿåº¦ï¼š

$$
z_1 = x = x_1, \quad z_2 = \dot{x} = x_2
$$

æ¢æˆçŸ©é˜µå…³ç³»ï¼Œå¾—åˆ°ï¼š

$$
\begin{bmatrix}
z_1 \\
z_2
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2
\end{bmatrix}
$$

æœ€åå¾—åˆ°ç¬¬äºŒä¸ªçŠ¶æ€æ–¹ç¨‹ï¼š

$$
Z_t = H X_t \tag{4}
$$


# ä¸‰ å¡å°”æ›¼æ»¤æ³¢å…¬å¼æ¨å¯¼

1. æ ¹æ®ä¸ŠèŠ‚å¾—åˆ°çŠ¶æ€ç©ºé—´æ–¹ç¨‹

   $$
   \begin{align}
   \dot X_t &= AX_{t-1}+BU_{t-1}+W_{t-1} \tag{1} \\
   Z_t &= H \cdot X_t + V_t \tag{2}
   \end{align}
   $$

   $$
   \begin{align*}
   A &: \text{çŠ¶æ€è½¬ç§»çŸ©é˜µ} \\
   B &: \text{æ§åˆ¶çŸ©é˜µ} \\
   U &: \text{æ§åˆ¶è¾“å…¥} \\
   W &: \text{è¿‡ç¨‹å™ªå£°} \sim (0,Q) \\
   H &: \text{è§‚æµ‹çŸ©é˜µ} \\
   V &: \text{æµ‹é‡å™ªå£°} \sim (0,R) \\
   \hat x_{t^-} &: t \text{æ—¶åˆ»çš„å…ˆéªŒä¼°è®¡} \\
   \hat x_t &: t \text{æ—¶åˆ»çš„åéªŒä¼°è®¡}
   \end{align*}
   $$
2. å¯ä»¥å¾—åˆ°é¢„æµ‹çš„å€¼å’Œæµ‹é‡çš„å€¼ï¼ˆå¿½ç•¥å™ªå£°çš„æƒ…å†µï¼‰

   $$
   \begin{align*}
   \hat X_{t^-} & = A\hat X_{t-1} + BU_{t-1} \\
   \hat X_{mea} & = H^{-1} Z_t
   \end{align*}
   $$
3. æ ¹æ®ä¸ŠèŠ‚å…¬å¼1ï¼Œå¯ä»¥å¾—åˆ°æ•°æ®èåˆçš„ç»“æœ

   $$
   \begin{align*}
   \hat X_t &= \hat X_{t^-} + G \cdot (H^{-1}Z_t - \hat X_{t^-}) \\
   \text{ä»¤ } G &= K_t H, \quad \hat X_t = \hat X_{t^-} + K_t \cdot (Z_t - H \hat X_{t^-}) \tag{3} \\
   \text{å½“ } K_t &= 0 \text{ æ—¶ï¼Œæ›´ç›¸ä¿¡é¢„æµ‹å€¼ï¼›å½“ } K_t = H^{-1} \text{ æ—¶ï¼Œæ›´ç›¸ä¿¡æµ‹é‡å€¼}
   \end{align*}
   $$

   **ç›®æ ‡ï¼šå¸Œæœ›èåˆåçš„ç»“æœæ— é™æ¥è¿‘çœŸå®å€¼**:

   $$
   e_t = X_t - \hat X_t
   $$

   $$
   \begin{align*}
   X_t - \hat X_t &= X_t - \hat X_{t^-} - K_t H X_t - K_t V_t + K_t H \hat X_{t^-} \\
   &= (I - K_t H)(X_t - \hat X_{t^-}) - K_t V_t \\
   &= (I - K_t H) e_{t^-} - K_t V_t \tag{4}
   \end{align*}
   $$

   $$
   \left\{
   \begin{array}{c}
   (AB)^T = B^T A^T \\
   (A + B)^T = A^T + B^T \tag{5}
   \end{array}
   \right.
   $$
4. tæ—¶åˆ»çš„è¯¯å·®åæ–¹å·®çŸ©é˜µ

   $$
   \begin{align*}
   P_{e_t} &= \mathbb{E}[e_t e_t^T] \\
   &= \mathbb{E}[(X_t - \hat X_t)(X_t - \hat X_t)^T] \\
   &= \mathbb{E}\left[(I - K_t H)e_{t^-} - K_t V_t\right] \cdot \mathbb{E}\left[(I - K_t H)e_{t^-} - K_t V_t\right]^T \\
   &= \mathbb{E}\left[(I - K_t H)e_{t^-} e_{t^-}^T (I - K_t H)^T\right] - \mathbb{E}\left[(I - K_t H)e_{t^-} V_t^T K_t^T\right] - \mathbb{E}\left[K_t V_t e_{t^-}^T (I - K_t H)^T\right] + \mathbb{E}\left[K_t V_t V_t^T K_t^T\right] \\
   &= (I - K_t H) \mathbb{E}[e_{t^-} e_{t^-}^T](I - K_t H)^T + K_t \mathbb{E}[V_t V_t^T] K_t^T \\
   &= (I - K_t H) P_{e_t}^-(I - K_t H)^T + K_t R K_t^T \\
   &= P_{e_t}^- - K_t H P_{e_t}^- - P_{e_t}^- H^T K_t^T + K_t H P_{e_t}^- H^T K_t^T + K_t R K_t^T \tag{6} \\
   &= P_{e_t}^- - 2 K_t H P_{e_t}^- + K_t H P_{e_t}^- H^T K_t^T + K_t R K_t^T \tag{7}
   \end{align*}
   $$

   > a. è€ƒè™‘ä¸€ä¸ªéšæœºå˜é‡ Xï¼Œå…¶åæ–¹å·®çŸ©é˜µä¸º Î£ï¼Œ  è¯¥å‘é‡çš„æ–¹å·®å¯ä»¥è¡¨ç¤ºä¸º Var(X) = Tr(Î£)ï¼›  
   > b. è¿™ä¸ªç»“è®ºæºè‡ªäºåæ–¹å·®çŸ©é˜µçš„å®šä¹‰ï¼š  
   >    **åæ–¹å·®çŸ©é˜µçš„å¯¹è§’çº¿ä¸Šçš„å…ƒç´ æ˜¯æ¯ä¸ªéšæœºå˜é‡çš„æ–¹å·®ï¼Œå› æ­¤å®ƒä»¬çš„å’Œç­‰äºæ–¹å·®å‘é‡çš„è¿¹ã€‚**  


   $$
   \left\{
   \begin{array}{c}
   \frac{d \text{Tr}(AB)}{dA} = B^T \\
   \frac{d(ABA)}{dA} = 2AB \tag{8}
   \end{array}
   \right.
   $$

   æ ¹æ®ä¸Šè¿°ç»“è®ºä»¥åŠå…¬å¼8ï¼Œè¦æ—¶çš„è¯¯å·®æœ€å°ï¼Œè¿¹æœ€å°

   $$
   \frac{d \text{Tr}(P_{e_t})}{dK_t} = 0 - 2(HP_t^-)^T + 2K_t HP_t^- H^T + 2K_t R = 0
   $$

   å¾—åˆ°å¡å°”æ›¼å¢ç›Šï¼š

   $$
   K_t = \frac{P_t^- H^T}{HP_t^- H^T + R} \tag{9}
   $$

   $$
   \begin{align*}
   \text{é¢„æµ‹è¯¯å·®åæ–¹å·®çŸ©é˜µï¼Œ} e_t^- &= X_t - \hat X_t^- \\
   &= AX_{t-1} + BU_{t-1} + W_{t-1} - A\hat X_{t-1} - BU_{t-1} \\
   &= A(X_{t-1} - \hat X_{t-1}) + W_{t-1} \\
   &= Ae_{t-1} + W_{t-1} \\

   P_t^- &= \mathbb{E}[e_t^-(e_t^-)^T] \\
   &= \mathbb{E}[(Ae_{t-1} + W_{t-1})(Ae_{t-1} + W_{t-1})^T] \\
   &= \mathbb{E}[(Ae_{t-1} + W_{t-1})(e_{t-1}^T A^T + W_{t-1}^T)] \\
   &= \mathbb{E}[Ae_{t-1} e_{t-1}^T A^T + (Ae_{t-1} W_{t-1}^T + W_{t-1} e_{t-1}^T A^T) + W_{t-1} W_{t-1}^T] \\
   e_{t-1} \text{ å’Œ } W_{t-1} \text{ ç›¸äº’ç‹¬ç«‹ï¼ŒæœŸæœ›ä¸º0ï¼Œ} \\
   &= A \mathbb{E}[e_{t-1} e_{t-1}^T] A^T + \mathbb{E}[W_{t-1} W_{t-1}^T] \\
   &= AP_{t-1} A^T + Q \tag{10}
   \end{align*}
   $$

<span style="color: green;">5. å¾—åˆ°å¡å°”æ›¼æ»¤æ³¢çš„äº”ä¸ªæ­¥éª¤</span>

$$
\left\{
\begin{align*}
\hat X_{t^-} &= A\hat X_{t-1} + BU_{t-1} \\
P_t^- &= AP_{t-1}A^T + Q \\
K_t &= \frac{P_t^- H^T}{HP_t^- H^T + R} \\
\hat X_t &= \hat X_{t^-} + K_t(Z_t - H\hat X_{t^-}) \\
P_t &= (I - K_t H)P_t^-
\end{align*}
\right.
$$
